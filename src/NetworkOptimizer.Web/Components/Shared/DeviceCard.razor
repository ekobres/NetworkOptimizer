@if (Device != null)
{
    <div class="device-card device-@Device.Status.ToLower()">
        <div class="device-header">
            <div class="device-icon">
                @{
                    var imagePath = GetDeviceImagePath(Device.Model);
                }
                @if (!string.IsNullOrEmpty(imagePath))
                {
                    <img src="@imagePath" alt="@Device.Model" class="device-image" />
                }
                else
                {
                    <span class="device-emoji">@GetDeviceIcon(Device.Type)</span>
                }
            </div>
            <div class="device-info">
                <h4 class="device-name">@Device.Name</h4>
                <div class="device-meta">
                    <span class="device-type">@Device.TypeDisplayName</span>
                    <div class="device-status">
                        <span class="status-dot"></span>
                        <span class="status-text">@Device.Status</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="device-body">
            <div class="device-detail">
                <span class="detail-label">IP Address:</span>
                <span class="detail-value">@Device.IpAddress</span>
            </div>
            @if (!string.IsNullOrEmpty(Device.Model))
            {
                <div class="device-detail">
                    <span class="detail-label">Model:</span>
                    <span class="detail-value">@Device.Model</span>
                </div>
            }
            @if (!string.IsNullOrEmpty(Device.Firmware))
            {
                <div class="device-detail">
                    <span class="detail-label">Firmware:</span>
                    <span class="detail-value">@Device.Firmware</span>
                </div>
            }
            @if (!string.IsNullOrEmpty(Device.Uptime))
            {
                <div class="device-detail">
                    <span class="detail-label">Uptime:</span>
                    <span class="detail-value">@Device.Uptime</span>
                </div>
            }
            @if (Device.ClientCount.HasValue)
            {
                <div class="device-detail">
                    <span class="detail-label">Clients:</span>
                    <span class="detail-value">@Device.ClientCount</span>
                </div>
            }
        </div>
    </div>
}

<style>
    .device-image {
        width: 48px;
        height: 48px;
        object-fit: contain;
    }

    .device-emoji {
        font-size: 2rem;
    }
</style>

@using NetworkOptimizer.Web.Services
@using NetworkOptimizer.Core.Enums
@inject IWebHostEnvironment Environment

@code {
    [Parameter]
    public DeviceInfo? Device { get; set; }

    private string? GetDeviceImagePath(string? model)
    {
        if (string.IsNullOrEmpty(model))
            return null;

        // Convention: model name lowercase + .png (e.g., "UCG-Fiber" ‚Üí "ucg-fiber.png")
        var imageFile = $"{model.ToLowerInvariant()}.png";
        var imagePath = Path.Combine(Environment.WebRootPath, "images", "devices", imageFile);

        if (File.Exists(imagePath))
            return $"/images/devices/{imageFile}";

        return null;
    }

    private string GetDeviceIcon(DeviceType deviceType)
    {
        return deviceType switch
        {
            DeviceType.Gateway => "üåê",
            DeviceType.Switch => "üîå",
            DeviceType.AccessPoint => "üì°",
            DeviceType.CellularModem => "üì∂",
            _ => "üñ•Ô∏è"
        };
    }
}
