window.onload=function(){var e=document.getElementById("OpenSpeedTest-UI");e.parentNode.replaceChild(e.contentDocument.documentElement,e),ostOnload(),OpenSpeedTest.Start()},function(e){var t,o,n=!1,s=function(e){e&&"function"==typeof e&&e()};function i(e){if(!(this instanceof i))return new i(e);this.el=document.getElementById(e)}i.prototype.fade=function(e,t,o){var n="in"===e,i=n?0:1,r=14/t,a=this;n&&(a.el.style.display="block",a.el.style.opacity=i);var l=window.setInterval(function(){i=n?i+r:i-r,a.el.style.opacity=i,i<=0&&(a.el.style.display="none"),(i<=0||i>=1)&&window.clearInterval(l,s(o))},14)};var r=function(e,t,o,n){return e/=n,o*(--e*e*e+1)+t},a=function(){this.YourIP=i("YourIP"),this.ipDesk=i("ipDesk"),this.ipMob=i("ipMob"),this.downSymbolDesk=i("downSymbolDesk"),this.upSymbolDesk=i("upSymbolDesk"),this.upSymbolMob=i("upSymbolMob"),this.downSymbolMob=i("downSymbolMob"),this.settingsMob=i("settingsMob"),this.settingsDesk=i("settingsDesk"),this.oDoLiveStatus=i("oDoLiveStatus"),this.ConnectErrorMob=i("ConnectErrorMob"),this.ConnectErrorDesk=i("ConnectErrorDesk"),this.downResult=i("downResult"),this.upRestxt=i("upRestxt"),this.pingResult=i("pingResult"),this.jitterDesk=i("jitterDesk"),this.pingMobres=i("pingMobres"),this.JitterResultMon=i("JitterResultMon"),this.JitterResultms=i("JitterResultms"),this.UI_Desk=i("UI-Desk"),this.UI_Mob=i("UI-Mob"),this.oDoTopSpeed=i("oDoTopSpeed"),this.startButtonMob=i("startButtonMob"),this.startButtonDesk=i("startButtonDesk"),this.intro_Desk=i("intro-Desk"),this.intro_Mob=i("intro-Mob"),this.loader=i("loading_app"),this.OpenSpeedtest=i("OpenSpeedtest"),this.mainGaugebg_Desk=i("mainGaugebg-Desk"),this.mainGaugeBlue_Desk=i("mainGaugeBlue-Desk"),this.mainGaugeWhite_Desk=i("mainGaugeWhite-Desk"),this.mainGaugebg_Mob=i("mainGaugebg-Mob"),this.mainGaugeBlue_Mob=i("mainGaugeBlue-Mob"),this.mainGaugeWhite_Mob=i("mainGaugeWhite-Mob"),this.oDoLiveSpeed=i("oDoLiveSpeed"),this.progressStatus_Mob=i("progressStatus-Mob"),this.progressStatus_Desk=i("progressStatus-Desk"),this.graphc1=i("graphc1"),this.graphc2=i("graphc2"),this.graphMob2=i("graphMob2"),this.graphMob1=i("graphMob1"),this.text=i("text"),this.scale=[{degree:680,value:0},{degree:570,value:.5},{degree:460,value:1},{degree:337,value:10},{degree:220,value:100},{degree:115,value:500},{degree:0,value:1e3}],this.element="",this.chart="",this.polygon="",this.width=200,this.height=50,this.maxValue=0,this.values=[],this.points=[],this.vSteps=5,this.measurements=[],this.points=[]};a.prototype.reset=function(){this.element="",this.chart="",this.polygon="",this.width=200,this.height=50,this.maxValue=0,this.values=[],this.points=[],this.vSteps=5,this.measurements=[],this.points=[]},a.prototype.ip=function(){var e=this;"block"===e.ipDesk.el.style.display?(e.ipDesk.el.style.display="none",e.ipMob.el.style.display="none"):(e.ipDesk.el.style.display="block",e.ipMob.el.style.display="block")},a.prototype.prePing=function(){this.loader.fade("out",500),this.OpenSpeedtest.fade("in",1e3)},a.prototype.app=function(){this.loader.fade("out",500,this.ShowAppIntro())},a.prototype.ShowAppIntro=function(){this.OpenSpeedtest.fade("in",1e3)},a.prototype.userInterface=function(){this.intro_Desk.fade("out",1e3),this.intro_Mob.fade("out",1e3,this.ShowUI())},a.prototype.ShowUI=function(){this.UI_Desk.fade("in",1e3),this.UI_Mob.fade("in",1e3,function(e){t="Loaded",console.log("Developed by Vishnu. Email --\x3e me@vishnu.pro")})},a.prototype.Symbol=function(e){0==e&&(this.downSymbolMob.el.style.display="block",this.downSymbolDesk.el.style.display="block",this.upSymbolMob.el.style.display="none",this.upSymbolDesk.el.style.display="none"),1==e&&(this.downSymbolMob.el.style.display="none",this.downSymbolDesk.el.style.display="none",this.upSymbolMob.el.style.display="block",this.upSymbolDesk.el.style.display="block"),2==e&&(this.downSymbolMob.el.style.display="none",this.downSymbolDesk.el.style.display="none",this.upSymbolMob.el.style.display="none",this.upSymbolDesk.el.style.display="none")},a.prototype.Graph=function(e,t){"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)});var o,n,s=this;if(0===t){var i=this.graphc1.el;o="line",this.graphMob2.el.style.display="none",this.graphMob1.el.style.display="block"}else i=this.graphc2.el,o="line2",this.graphMob1.el.style.display="none",this.graphMob2.el.style.display="block";isNaN(e)?this.values.push(""):this.values.push(e),e>0&&function(){!function(){for(s.maxValue=0,n=0;n<s.values.length;n++)s.values[n]>s.maxValue&&(s.maxValue=s.values[n]);s.maxValue=Math.ceil(s.maxValue)}(),function(){if(s.values.length>1){var e="0,"+s.height+" ";for(n=0;n<s.values.length;n++){var t=s.values[n]/s.maxValue;e+=(130/(s.values.length-1)*n).toFixed(2)+","+(s.height-s.height*t).toFixed(2)+" "}e+="130,"+s.height,s.points=e}}(),function(){for(n=0;n<s.vSteps;n++){var e=Math.ceil(s.maxValue/s.vSteps*(n+1));s.measurements.push(e)}s.measurements.reverse()}();for(var e=document.getElementsByClassName(o);e.length>0;)e[0].remove();s.polygon=document.createElementNS("http://www.w3.org/2000/svg","polygon"),s.polygon.setAttribute("points",s.points),s.polygon.setAttribute("class",o),s.values.length>1&&i.appendChild(s.polygon)}()},a.prototype.progress=function(e,t){var n=this,s=t,i=e,a=Date.now(),l=setInterval(function(){var e=(Date.now()-a)/1e3,t=r(e,400,400,s),u=r(e,400,-400,s);i?(n.progressStatus_Desk.el.style.strokeDashoffset=t,n.progressStatus_Mob.el.style.strokeDashoffset=t):(n.progressStatus_Desk.el.style.strokeDashoffset=u,n.progressStatus_Mob.el.style.strokeDashoffset=u),e>=s&&(clearInterval(l),o="done",n.progressStatus_Desk.el.style.strokeDashoffset=800,n.progressStatus_Mob.el.style.strokeDashoffset=800)},14)},a.prototype.mainGaugeProgress=function(e){var t=e;t<0&&(t=0);var o=this.getNonlinearDegree(t);e>0&&(this.mainGaugeBlue_Desk.el.style.strokeOpacity=1,this.mainGaugeWhite_Desk.el.style.strokeOpacity=1,this.mainGaugeBlue_Mob.el.style.strokeOpacity=1,this.mainGaugeWhite_Mob.el.style.strokeOpacity=1,this.mainGaugeBlue_Desk.el.style.strokeDashoffset=o,this.mainGaugeWhite_Desk.el.style.strokeDashoffset=0==o?1:o+1,this.mainGaugeBlue_Mob.el.style.strokeDashoffset=o,this.mainGaugeWhite_Mob.el.style.strokeDashoffset=0==o?1:o+1),0==o&&t>1e3?(this.mainGaugeBlue_Mob.el.style.strokeDashoffset=o>=681?681:o,this.mainGaugeWhite_Mob.el.style.strokeDashoffset=0==o?1:o+1,this.mainGaugeWhite_Desk.el.style.strokeDashoffset=0==o?1:o+1,this.mainGaugeBlue_Desk.el.style.strokeDashoffset=o>=681?681:o):0==o&&t<=0&&(this.mainGaugeBlue_Mob.el.style.strokeDashoffset=681.1,this.mainGaugeWhite_Mob.el.style.strokeDashoffset=.1,this.mainGaugeWhite_Desk.el.style.strokeDashoffset=.1,this.mainGaugeBlue_Desk.el.style.strokeDashoffset=681.1)},a.prototype.showStatus=function(e){this.oDoLiveStatus.el.textContent=e},a.prototype.ConnectionError=function(){this.ConnectErrorMob.el.style.display="block",this.ConnectErrorDesk.el.style.display="block"},a.prototype.uploadResult=function(e){e<1&&(this.upRestxt.el.textContent=e.toFixed(3)),e>=1&&e<9999&&(this.upRestxt.el.textContent=e.toFixed(1)),e>=1e4&&e<99999&&(this.upRestxt.el.textContent=e.toFixed(1),this.upRestxt.el.style.fontSize="20px"),e>=1e5&&(this.upRestxt.el.textContent=e.toFixed(1),this.upRestxt.el.style.fontSize="18px")},a.prototype.pingResults=function(e,t){var o=e;"Ping"===t&&(o>=1&&o<1e4?(this.pingResult.el.textContent=Math.floor(o),this.pingMobres.el.textContent=Math.floor(o)):o>=0&&o<1&&(0==o&&(o=0),this.pingResult.el.textContent=o,this.pingMobres.el.textContent=o)),"Error"===t&&(this.oDoLiveSpeed.el.textContent=o)},a.prototype.downloadResult=function(e){e<1&&(this.downResult.el.textContent=e.toFixed(3)),e>=1&&e<9999&&(this.downResult.el.textContent=e.toFixed(1)),e>=1e4&&e<99999&&(this.downResult.el.textContent=e.toFixed(1),this.downResult.el.style.fontSize="20px"),e>=1e5&&(this.downResult.el.textContent=e.toFixed(1),this.downResult.el.style.fontSize="18px")},a.prototype.jitterResult=function(e,t){var o=e;if("Jitter"===t)if(o>=1&&o<1e4){if(this.jitterDesk.el.textContent=Math.floor(o),o>=1&&o<100&&(this.JitterResultMon.el.textContent=Math.floor(o)),o>=100){var n=(o/1e3).toFixed(1);this.JitterResultMon.el.textContent=n+"k"}}else o>=0&&o<1&&(0==o&&(o=0),this.jitterDesk.el.textContent=o,this.JitterResultMon.el.textContent=o)},a.prototype.LiveSpeed=function(e,t){var o=e;if("countDown"!==t){if("speedToZero"===t)return"number"==typeof o&&(o=o.toFixed(1)),o<=0&&(o=0),this.oDoLiveSpeed.el.textContent=o,this.oDoTopSpeed.el.textContent="1000+",this.oDoTopSpeed.el.style.fontSize="16.9px",void(this.oDoTopSpeed.el.style.fill="gray");if("Ping"===t)o>=1&&o<1e4?this.oDoLiveSpeed.el.textContent=Math.floor(o):o>=0&&o<1&&(0==o&&(o=0),this.oDoLiveSpeed.el.textContent=o);else{if(0==o){n=o.toFixed(0);this.oDoLiveSpeed.el.textContent=n}if(o<=1&&o>0){n=o.toFixed(3);this.oDoLiveSpeed.el.textContent=n}if(o>1){n=o.toFixed(1);this.oDoLiveSpeed.el.textContent=n}o<=1e3&&(this.oDoTopSpeed.el.textContent="1000+",this.oDoTopSpeed.el.style.fontSize="16.9px",this.oDoTopSpeed.el.style.fill="gray"),o>=1010&&(this.oDoTopSpeed.el.textContent=1e3*Math.floor(o/1010)+"+",this.oDoTopSpeed.el.style.fill="gray",this.oDoTopSpeed.el.style.fontSize="17.2px")}}else{var n=o.toFixed(0);this.oDoLiveSpeed.el.textContent=n}},a.prototype.GaugeProgresstoZero=function(e,o){var n=e,s=this;if(n>=0)var i=Date.now(),r=0-n,a=setInterval(function(){var e,l=(Date.now()-i)/1e3,u=(e=l,e/=3,r*(--e*e*e*e*e+1)+n);s.LiveSpeed(u,"speedToZero"),s.mainGaugeProgress(u),(l>=3||u<=0)&&(clearInterval(a),s.LiveSpeed(0,"speedToZero"),s.mainGaugeProgress(0),t=o)},16)},a.prototype.getNonlinearDegree=function(e){var t=0;if(0==e||e<=0||isNaN(e))return 0;for(;t<this.scale.length;){if(!(e>this.scale[t].value))return this.scale[t-1].degree+(e-this.scale[t-1].value)*(this.scale[t].degree-this.scale[t-1].degree)/(this.scale[t].value-this.scale[t-1].value);t++}return this.scale[this.scale.length-1].degree};var l=function(){this.OverAllTimeAvg=window.performance.now(),this.SpeedSamples=[],this.FinalSpeed};l.prototype.reset=function(){this.OverAllTimeAvg=window.performance.now(),this.SpeedSamples=[],this.FinalSpeed=0},l.prototype.ArraySum=function(e){return e?e.reduce(function(e,t){if("number"==typeof e&&"number"==typeof t)return e+t},0):0},l.prototype.AvgSpeed=function(e,t,o){var n=this;this.timeNow=(window.performance.now()-this.OverAllTimeAvg)/1e3,this.FinalSpeed;var s=t;return s=o-s,this.timeNow>=s&&(e>0&&this.SpeedSamples.push(e),n.FinalSpeed=n.ArraySum(n.SpeedSamples)/n.SpeedSamples.length),n.FinalSpeed},l.prototype.uRandom=function(e,t){var o=new Uint32Array(262144);function n(){for(var e=o.length,t=0;t<e;t++)o[t]=4294967296*Math.random();return o}var i=[];return new Blob(function(e){for(var t=0;t<e;t++)i[t]=n();return i}(e),{type:"application/octet-stream"},s(t))},l.prototype.addEvt=function(e,t,o){e.addEventListener(t,o)},l.prototype.remEvt=function(e,t,o){e.removeEventListener(t,o)};var u=function(){var e,s=new l,i=new a;i.app();var r,u,p,d,h,c,f,g,y,v,m,w,S,D,b,k,x,M,R=location.hostname,T=[],C=0,I=0,L=0,E=0;function _(){m=0,L=0}x=window.navigator.userAgent?window.navigator.userAgent:"Not Found";var G=.6*ulDuration,F=.6*dlDuration;function P(){.6*ulDuration>=7&&(G=7),.6*dlDuration>=7&&(F=7)}P();var A=!0,B=!0;s.addEvt(i.settingsMob.el,"click",re),s.addEvt(i.settingsDesk.el,"click",re),s.addEvt(i.startButtonDesk.el,"click",ae),s.addEvt(i.startButtonMob.el,"click",ae),s.addEvt(document,"keypress",de);var U,N,O,j,H=!0,J=function(e){var t={},o=document.createElement("a");o.href=e;for(var n=o.search.substring(1).split("&"),s=0;s<n.length;s++){var i=n[s].split("=");t[i[0]]=decodeURIComponent(i[1])}return t}(window.location.href.toLowerCase());setPingSamples&&("string"!=typeof J.ping&&"string"!=typeof J.p||(void 0!==J.ping?U=J.ping:void 0!==J.p&&(U=J.p),U>0&&(pingSamples=U,pingSamples=U)));setPingTimeout&&("string"!=typeof J.out&&"string"!=typeof J.o||(void 0!==J.out?N=J.out:void 0!==J.o&&(N=J.o),N>1&&(pingTimeOut=N,pingTimeOut=N)));setHTTPReq&&("string"!=typeof J.xhr&&"string"!=typeof J.x||(void 0!==J.xhr?O=J.xhr:void 0!==J.x&&(O=J.x),O>0&&O<=32&&(dlThreads=O,ulThreads=O)));selectServer&&("string"!=typeof J.host&&"string"!=typeof J.h||(void 0!==J.host?j=J.host:void 0!==J.h&&(j=J.h),/(?:https?):\/\/(\w+:?\w*)?(\S+)(:\d+)?(\/|\/([\w#!:.?+=&%!\-\/]))?/.test(j)&&(openSpeedTestServerList=[{ServerName:"Home",Download:j+"/downloading",Upload:j+"/upload",ServerIcon:"DefaultIcon"}])));var W,z,V=parseInt(J.stress),q=parseInt(J.s);"string"==typeof J.stress?(W=J.stress,z=V):"string"==typeof J.s&&(W=J.s,z=q),W&&stressTest&&("low"!==W&&"l"!==W||(dlDuration=300,ulDuration=300),"medium"!==W&&"m"!==W||(dlDuration=600,ulDuration=600),"high"!==W&&"h"!==W||(dlDuration=900,ulDuration=900),"veryhigh"!==W&&"v"!==W||(dlDuration=1800,ulDuration=1800),"extreme"!==W&&"e"!==W||(dlDuration=3600,ulDuration=3600),"day"!==W&&"d"!==W||(dlDuration=86400,ulDuration=86400),"year"!==W&&"y"!==W||(dlDuration=31557600,ulDuration=31557600),(V>0||q>0)&&(dlDuration=z,ulDuration=z)),M=dlDuration,F=.6*dlDuration,G=.6*ulDuration,P();var Z=parseInt(J.clean),X=parseInt(J.c),Y=1;Z?Y=Z:X&&(Y=X),enableClean&&("string"!=typeof J.clean&&"string"!=typeof J.c||(Z>=1||X>=1?(Z<5||X<5)&&(upAdjust=1+Y/100,dlAdjust=1+Y/100):(upAdjust=1,dlAdjust=1)));var Q,K=parseInt(J.run),$=parseInt(J.r);enableRun&&("string"!=typeof J.run&&"string"!=typeof J.r||(Q=K>0?K:$>0?$:0)),Q>=0&&A&&ae();var ee,te=J.test,oe=J.t,ne=!1;selectTest&&("string"!=typeof te&&"string"!=typeof oe||(te?(ee=te,ne=te):oe&&(ee=oe,ne=oe),"download"===ee||"d"===ee?(d=0,c=0,ne="Download",A&&ae()):"upload"===ee||"u"===ee?(p=0,h=0,ne="Upload",E=1,A&&ae()):"ping"===ee||"p"===ee?(d=0,c=0,p=0,h=0,ne="Ping",A&&ae()):ne=!1));var se=0;var ie=!1;function re(){ie&&(i.YourIP.el.textContent="Please wait..",Ye(7),ie=!1),i.ip()}function ae(){if(n=!1,H&&(s.remEvt(i.settingsMob.el,"click",re),s.remEvt(i.settingsDesk.el,"click",re),s.remEvt(i.startButtonDesk.el,"click",ae),s.remEvt(i.startButtonMob.el,"click",ae),s.remEvt(document,"keypress",de),H=!1),Q>=0){A=!1,i.userInterface(),B=!1;var e=Math.ceil(Math.abs(Q));i.showStatus("Automatic Test Starts in ...");var t=setInterval(function(){e>=1?(e-=1,i.LiveSpeed(e,"countDown")):e<=0&&(clearInterval(t),A=!0,Q=void 0,ae())},1e3)}"fetch"===openSpeedTestServerList&&!0===A&&(A=!1,i.showStatus("Fetching Server Info.."),Ye(6)),!0===A&&("Ping"===ne||"Download"===ne||"Upload"===ne||!1===ne)&&ce()}var le="OpenSpeedTest",ue=".com",pe=le+"™";function de(e){"Enter"===e.key&&ae()}var he=0;function ce(){B&&(i.userInterface(),B=!1),function(){"widget"!==openChannel&&"web"!==openChannel||Ye(1);function r(){b=window.performance.now(),function(){for(var e=0;e<ulThreads;e++)setTimeout(function(e){je(e)},ulDelay*e,e)}()}var a=setInterval(function(){if("Loaded"===t&&(t="busy",qe()),"Ping"===t&&(t="busy",i.showStatus("Milliseconds")),"Download"===t&&(i.showStatus("Initializing.."),s.reset(),_(),i.reset(),D=window.performance.now(),function(){for(var e=0;e<dlThreads;e++)setTimeout(function(e){Pe(e)},dlDelay*e,e)}(),t="initDown"),"Downloading"===t){if(i.Symbol(0),0==se){se=1,i.showStatus("Testing download speed..");var l=(window.performance.now()-D)/1e3;fe=l,i.progress(1,dlDuration+2.5),dlDuration+=l}S=(window.performance.now()-D)/1e3,!n&&1==se&&S>=3&&(n=!0,fetch(saveDataURL.replace("/results","/topology-snapshots"),{method:"POST",mode:"cors"}).catch(function(){})),Fe("dl"),i.showStatus("Mbps download"),i.mainGaugeProgress(L),i.LiveSpeed(L),i.Graph(L,0),p=s.AvgSpeed(L,F,dlDuration),S>=dlDuration&&"done"==o&&(ne?(i.GaugeProgresstoZero(L,"SendR"),i.showStatus("Complete"),i.Symbol(2),saveData&&Xe("Please wait...","waiting")):i.GaugeProgresstoZero(L,"Upload"),i.downloadResult(p),h=C,E=1,t="busy",_(),s.reset())}if("Upload"==t&&1===E&&(i.Symbol(1),t="initup",i.showStatus("Initializing.."),i.LiveSpeed("...","speedToZero"),e=s.uRandom(ulDataSize,r),ne&&(se=1)),"Uploading"===t){if(1==se){se=2,i.showStatus("Testing upload speed.."),L=0,s.reset(),i.reset();var u=(window.performance.now()-b)/1e3;ge=u,i.progress(!1,ulDuration+2.5),ulDuration+=u}i.showStatus("Mbps upload"),w=(window.performance.now()-b)/1e3,Fe("up"),i.mainGaugeProgress(L),i.LiveSpeed(L),i.Graph(L,1),d=s.AvgSpeed(L,G,ulDuration),w>=ulDuration&&1==E&&(c=I,i.uploadResult(d),i.GaugeProgresstoZero(L,"SendR"),e=void 0,i.showStatus("Complete"),i.Symbol(2),saveData&&Xe("Please wait...","waiting"),t="busy",E=0)}if("Error"===t){i.showStatus("Check your network connection status."),i.ConnectionError(),t="busy",clearInterval(a);var y=document.createElement("div");y.innerHTML='<a xlink:href="https://openspeedtest.com/FAQ.php?ref=NetworkError" style="cursor: pointer" target="_blank"></a>';var v=y.querySelector("a");i.oDoLiveSpeed.el.textContent="Network Error";var m=document.getElementById("oDoLiveSpeed");v.innerHTML=m.innerHTML,m.innerHTML=y.innerHTML}if("SendR"===t){if(i.showStatus("Complete"),i.oDoLiveSpeed.el.textContent=pe,location.hostname!=le.toLowerCase()+ue){if(k="d="+p.toFixed(3)+"&u="+d.toFixed(3)+"&p="+f+"&j="+g+"&dd="+(h/1048576).toFixed(3)+"&ud="+(c/1048576).toFixed(3)+"&ua="+x+"&dur="+M,"undefined"!=typeof clientResultsUrl){var R=document.getElementById("resultsData");R.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",clientResultsUrl),R.setAttribute("target","_blank"),R.onclick=function(e){var t=Ze||clientResultsUrl;window.opener&&!window.opener.closed?(e.preventDefault(),window.opener.focus(),window.close()):(e.preventDefault(),window.open(t,"_blank"))}}saveData&&Ye(5)}else Ye(3);t="busy",clearInterval(a)}},100)}()}"web"===openChannel&&(he=webRe,ie=!0),"widget"===openChannel&&(he=widgetRe,ie=!0),"selfwidget"===openChannel&&(he=widgetRe,u=domainx,R=u),openChannel;var fe,ge,ye,ve,me=0,we=0,Se=0,De=0,be=0,ke=0,xe=0,Me=0,Re=0,Te=0,Ce=0,Ie=0,Le=0,Ee=0,_e=1e3*dlDuration-6e3,Ge=1e3*ulDuration-6e3;function Fe(e){if("dl"===e){var t=1e3*S;t>1e3*fe+F/2*1e3&&0===xe&&(xe=1,ke*=.01,Se*=.01,ye=t+1e4),t>=ye&&ye<_e&&(ye+=1e4,ke*=.01,Se*=.01),me=C<=0?0:C-we,we=C,De=be=t-be,be=t,ke+=De,(Se+=me)>0&&(m=Se/ke/125*dlAdjust,L=m)}if("up"===e){var o=1e3*w;o>1e3*ge+G/2*1e3&&0===Ee&&(Ee=1,Le*=.1,Te*=.1,ve=o+1e4),o>=ve&&ve<Ge&&(ve+=1e4,Le*=.1,Te*=.1),Me=I<=0?0:I-Re,Re=I,Ce=Ie=o-Ie,Ie=o,Le+=Ce,(Te+=Me)>0&&(m=Te/Le/125*upAdjust,L=m)}}function Pe(e){var o=0,n=new XMLHttpRequest;T[e]=n,T[e].open("GET",Ae.Download+"?n="+Math.random(),!0),T[e].onprogress=function(n){if(1===E)return T[e].abort(),T[e]=null,T[e]=void 0,delete T[e],!1;"initDown"==t&&(t="Downloading");var s=n.loaded<=0?0:n.loaded-o;if(isNaN(s)||!isFinite(s)||s<0)return!1;C+=s,o=n.loaded},T[e].onload=function(n){0===o&&(C+=n.total),"initDown"==t&&(t="Downloading"),T[e]&&(T[e].abort(),T[e]=null,T[e]=void 0,delete T[e]),0===E&&Pe(e)},T[e].onerror=function(t){0===E&&Pe(e)},T[e].responseType="arraybuffer",T[e].send()}var Ae,Be,Ue,Ne,Oe=[];function je(o){var n=0,s=new XMLHttpRequest;Oe[o]=s,Oe[o].open("POST",Ae.Upload+"?n="+Math.random(),!0),Oe[o].upload.onprogress=function(e){"initup"==t&&(t="Uploading");if(w>=ulDuration)return Oe[o].abort(),Oe[o]=null,Oe[o]=void 0,delete Oe[o],!1;var s=e.loaded<=0?0:e.loaded-n;if(isNaN(s)||!isFinite(s)||s<0)return!1;I+=s,n=e.loaded},Oe[o].onload=function(){if(0===n&&(I+=1048576*ulDataSize,w>=ulDuration))return Oe[o].abort(),Oe[o]=null,Oe[o]=void 0,delete Oe[o],!1;"initup"==t&&(t="Uploading");Oe[o]&&(Oe[o].abort(),Oe[o]=null,Oe[o]=void 0,delete Oe[o]),1===E&&je(o)},Oe[o].onerror=function(e){w<=ulDuration&&je(o)},Oe[o].setRequestHeader("Content-Type","application/octet-stream"),o>0&&I<=17e3||Oe[o].send(e)}var He=-1,Je=[],We=[],ze=[],Ve=openSpeedTestServerList.length;function qe(){if(Ve=openSpeedTestServerList.length,t="Ping",performance.clearResourceTimings(),He<Ve-1)He++,"Stop"!=Ne&&function(e,t){var o=0,n=[],s=[];function r(){if(o<pingSamples)o++,"Stop"!=Ne&&a();else if(n.length>1){s.sort(function(e,t){return e-t});var i=(s=(s=s.slice(0,s.length*jitterFinalSample)).reduce(function(e,t){return e+t},0)/s.length).toFixed(1),r=Math.min.apply(Math,n);Je.push(r),We.push(e),ze.push(i),"function"==typeof t&&t()}else"function"==typeof t&&t()}function a(){var t=new XMLHttpRequest;"Stop"!=Ne&&t.abort(),t.open(pingMethod,e[pingFile]+"?n="+Math.random(),!0),t.timeout=pingTimeOut;var a=window.performance.now();t.send(),t.onload=function(){if(200===this.status&&4===this.readyState){var e,t=Math.floor(window.performance.now()-a),l=performance.getEntries();if(e="xmlhttprequest"===(l=l[l.length-1]).initiatorType?parseFloat(l.duration.toFixed(1)):t,o>250&&(e=t),e<=0?n.push(.1):n.push(e),n.length>1){var u=Math.abs(n[n.length-1]-n[n.length-2]).toFixed(1);s.push(parseFloat(u)),i.LiveSpeed(e,"Ping"),i.pingResults(e,"Ping"),i.jitterResult(u,"Jitter")}r()}404===this.status&&4===this.readyState&&(o++,r())},t.onerror=function(e){o++,r()},t.ontimeout=function(e){o++,r()}}a()}(openSpeedTestServerList[He],qe);else if(We.length>=1){var e=Math.min.apply(Math,Je),o=Je.indexOf(e);Ae=We[o],Be=e,Ue=ze[o],Ne="Busy",i.LiveSpeed(Be,"Ping"),i.pingResults(Be,"Ping"),i.jitterResult(Ue,"Jitter"),f=Be,g=Ue,t=ne?"Ping"==ne?"SendR":ne:"Download"}else We.Download||(t="Error")}var Ze=null,Xe=function(e,t,o){var n=document.getElementById("save-notification");n&&(n.textContent=e,n.className="save-notification show"+(t?" "+t:""),n.onclick=null,"success"===t?setTimeout(function(){Xe("View Results →","clickable",Ze)},2e3):"error"===t?setTimeout(function(){n.className="save-notification"},3e3):"clickable"===t&&o&&(n.onclick=function(){window.opener&&!window.opener.closed?(window.opener.focus(),window.close()):(window.open(o,"_blank"),n.className="save-notification")}))},Ye=function(e){var t=new XMLHttpRequest,o=OpenSpeedTestdb;1==e&&(o=webIP),5==e&&(o=saveDataURL),7==e&&(o=get_IP),t.open("POST",o,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){if(4==t.readyState&&200==t.status){if(v=t.responseText.trim(),2==e&&(r=v),1==e&&(u=v),3==e&&setTimeout(function(){location.href=he+v},1500),5==e){try{var o=JSON.parse(v);if(o.id&&"undefined"!=typeof clientResultsUrl){Ze=clientResultsUrl+"#result-"+o.id;var n=document.getElementById("resultsData");n&&n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Ze)}}catch(e){Ze="undefined"!=typeof clientResultsUrl?clientResultsUrl:null}Xe("Result saved.","success")}6==e&&(openSpeedTestServerList=JSON.parse(v),A=!0,ae()),7==e&&(i.YourIP.el.textContent=v)}4==t.readyState&&200!=t.status&&5==e&&Xe("Failed to save result.","error")},2==e&&(y="r=n"),3==e&&(y="r=l&d="+p+"&u="+d+"&dd="+h/1048576+"&ud="+c/1048576+"&p="+f+"&do="+R+"&S="+r+"&sip="+u+"&jit="+g+"&ua="+x),5==e&&(y=k),6==e&&(y="r=s"),t.send(y)}};e.Start=function(){new u}}(window.OpenSpeedTest=window.OpenSpeedTest||{});